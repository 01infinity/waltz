<div>
    <!-- HEADER -->
    <waltz-page-header name="{{ ctrl.lineageReport.name }}"
                       small="Lineage Editor"
                       icon="qrcode">
        <ol class="waltz-breadcrumbs">
            <li><a ui-sref="main">Home</a></li>
            <li>
                <a ui-sref="main.app.view ({ id: ctrl.owningApp.id })">
                    <span ng-bind="ctrl.owningApp.name"></span>
                </a>
            </li>
            <li>
                <a ui-sref="main.physical-data-article.view ({ id: ctrl.article.id })">
                    <span ng-bind="ctrl.article.name"></span>
                </a>
            </li>
            <li>Lineage</li>
            <li>
                <a ui-sref="main.lineage-report.view ({ id: ctrl.lineageReport.id })"
                   ng-bind="ctrl.lineageReport.name">
                </a>
            </li>
            <li>Edit</li>
        </ol>
    </waltz-page-header>


    <div class="waltz-page-summary waltz-page-summary-attach">
        <div class="row">
            <div class="col-sm-2">
                <label>
                    Report Name:
                </label>
            </div>
            <div class="col-sm-10 waltz-visibility-parent">
                <waltz-editable-field on-save="ctrl.updateName"
                                      field-type="text"
                                      initial-val="ctrl.lineageReport.name">
                </waltz-editable-field>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-2">
                <label>
                    Report Description:
                </label>
            </div>
            <div class="col-sm-10">
                <waltz-editable-field on-save="ctrl.updateDescription"
                                      field-type="textarea"
                                      initial-val="ctrl.lineageReport.description">
                </waltz-editable-field>
            </div>
        </div>

        <hr>
        <div class="row">
            <div class="col-sm-3">
                <strong>
                    <waltz-icon name="info-circle"></waltz-icon>
                    This report describes the lineage for physical data article:
                    <br>
                    <a ui-sref="main.physical-data-article.view ({ id: ctrl.article.id })"
                       ng-bind="ctrl.article.name"></a>
                </strong>
            </div>
            <div class="col-sm-9">
                <div style="border: 1px solid #f4f4f4; border-radius: 3px; padding: 12px">
                    <waltz-physical-data-article-overview owning-app="ctrl.owningApp"
                                                          article="ctrl.article"
                                                          organisational-unit="ctrl.organisationalUnit">
                    </waltz-physical-data-article-overview>
                </div>
            </div>
        </div>

    </div>

    <br>

    <waltz-section name="edit">
        <div class="row">
            <div class="col-sm-12">
                <h4>Contributors</h4>
                <table class="table table-condensed small">
                    <thead>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="c in $ctrl.contributors">
                        <td><span ng-bind="c.article.name"></span></td>
                        <td><span ng-bind="c.logicalFlow.target.name"></span></td>
                        <td><span ng-bind="c.article.format"></span></td>
                        <td><span ng-bind="c.physicalFlow.transport"></span></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <hr>

        <div class="row">
            <div class="col-sm-9">
                <h4 ng-bind="ctrl.searchResults.app.name"></h4>

                <waltz-lineage-candidate-editor logical-flows="ctrl.searchResults.logicalFlows"
                                                physical-flows="ctrl.searchResults.physicalFlows"
                                                articles="ctrl.searchResults.articles"
                                                on-add="ctrl.addPhysicalFlowToLineage"
                                                on-remove="ctrl.removePhysicalFlowFromLineage"
                                                on-refocus="ctrl.doSearch">
                </waltz-lineage-candidate-editor>

            </div>
            <div class="col-sm-3">
                <waltz-app-selector model="ctrl.selectedApp"></waltz-app-selector>

            </div>
        </div>


    </waltz-section>

    <waltz-section name="dump">
        <div class="row">
            <div class="col-sm-3">
                <h4>Search Results</h4>
                <pre ng-bind="ctrl.searchResults | json"></pre>
            </div>
            <div class="col-sm-3">
                <h4>Contributors</h4>
                <pre ng-bind="ctrl.contributors"></pre>
            </div>
            <div class="col-sm-3">
                <h4></h4>
                <pre ng-bind="ctrl.xxx"></pre>
            </div>
            <div class="col-sm-3">
                <h4></h4>
                <pre ng-bind="ctrl.xxx"></pre>
            </div>
        </div>
    </waltz-section>
</div>