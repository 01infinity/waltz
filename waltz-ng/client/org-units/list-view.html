<div>
    <waltz-page-header name="Organisational Units"
                       icon="sitemap">
        <ol class="waltz-breadcrumbs">
            <li><a ui-sref="main">Home</a></li>
            <li>Organisational Units</li>
        </ol>
    </waltz-page-header>

    <blockquote>
        The structure of the organisational hierarchy.
        An application is assigned to one of the organisational units and the unit inherits the characteristics of the
        assigned application. The organisational hierarchy allow applications statistics and capabilities to be
        aggregated up the tree.
    </blockquote>


    <!-- DIAGRAMS -->
    <waltz-section name="Organisational Unit"
                   small="Overview"
                   ng-if="ctrl.diagrams.length > 0">
        <waltz-svg-diagrams diagrams="ctrl.diagrams"
                            block-processor="ctrl.blockProcessor">
        </waltz-svg-diagrams>
    </waltz-section>


    <!-- TREE -->
    <waltz-section name="Tree">

        <tree-control class="tree-classic"
                     tree-model="ctrl.trees"
                     options="ctrl.treeOptions">
            <span class="waltz-visibility-parent">
                <strong ng-bind="node.name">
                </strong>
                <span class="waltz-visibility-child-10 small" ng-bind="node.shortDescription"></span>
            </span>
        </tree-control>
    </waltz-section>


    <!-- SEARCH -->
    <waltz-section name="Organisational Units"
                   small="Search"
                   ng-init="qry=''">
        <div class="row">
            <div class="col-md-5">
                <input type="search"
                       class="form-control"
                       ng-model="qry"
                       placeholder="Search">
            </div>
        </div>
        <br>
        <div ng-if="qry.length <= 2">
            <div class="alert alert-warning">
                Please enter a search term
            </div>
        </div>

        <div ng-if="qry.length > 2">
            <table class="table table-condensed">
                <colgroup>
                    <col width="20%">
                    <col width="60%">
                    <col width="20%">
                </colgroup>
                <tbody>
                <tr ng-repeat="node in ctrl.flatUnits | orderBy:'unit.name' | filter:qry | limitTo:50">
                    <td>
                        <a ui-sref="main.org-units.unit ({ id: {{node.unit.id}} })"
                           class="waltz-org-unit-name"
                           ng-bind="node.unit.name">
                        </a>
                    </td>
                    <td>
                        <span class="small" bg-bind="node.unit.description">
                        </span>
                    </td>
                    <td>
                        <span ng-if="ctrl.talliesById[node.unit.id] > 0"
                              class="small waltz-tally-count"
                              title="Number of applications">
                            <span ng-bind="ctrl.talliesById[node.unit.id]"></span>
                            application/s
                        </span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </waltz-section>

    <div class="alert alert-info">
        <waltz-data-extract-link name="Download All"
                                 extract="org-units">
        </waltz-data-extract-link>
    </div>

</div>

