<div class="waltz-rated-flow-detail">
    <div ng-if="ctrl.eventData.type == ctrl.eventTypes.APP_RATING_CELL_SELECTED" class="waltz-detail-callout">
        <h4 style="border-bottom: 1px solid #ccc; padding-bottom: 4px;">
            {{ ctrl.findAppName(ctrl.eventData) }}
            <small>{{ ctrl.eventData.data.key | toDisplayName:'dataType' }}</small>
            <small class="clickable pull-right dismiss" ng-click="ctrl.eventData = null">(X)</small>
        </h4>

        <div ng-repeat="ratingGroup in ctrl.eventData.data.values" style="padding-bottom: 6px">
            <h5> {{ ratingGroup.key | toDisplayName:'rating' }} </h5>
            <div ng-repeat="source in ratingGroup.values" style="border-top: 1px dotted #ddd">
                <a ui-sref="main.app.view ({id: source.dataFlow.target.id})">{{ source.dataFlow.target.name }}</a>
                <span class="text-muted">sources data from</span>
                <strong>
                    <a ui-sref="main.app.view ({id: source.dataFlow.source.id})">
                        {{ source.dataFlow.source.name }}
                    </a>
                </strong>
            </div>
        </div>
    </div>

    <div ng-if="ctrl.eventData.type == ctrl.eventTypes.APP_SELECTED" class="waltz-detail-callout">
        <h3 style="border-bottom: 1px solid #ccc; padding-bottom: 4px;">
            {{ ctrl.eventData.data.app.name }}
            <small class="clickable pull-right dismiss" ng-click="ctrl.eventData = null">(X)</small>
        </h3>

        <p class="text-muted">
            {{ ctrl.eventData.data.app.description }}
        </p>
        <div ng-repeat="typeGroup in ctrl.eventData.data.values" style="padding-bottom: 6px">
            <h4>
                <a ng-click="ctrl.typeGroupSelected(typeGroup)"
                   class="clickable">
                    {{ typeGroup.key | toDisplayName:'dataType' }}
                </a>
            </h4>
            <ul class="list-unstyled">
                <li ng-repeat="ratingGroup in typeGroup.values">
                    {{ ratingGroup.key | toDisplayName:'rating' }}
                    :
                    {{ ratingGroup.values.length }}
                </li>
            </ul>
        </div>

        <div style="border-top: 1px solid #ddd">
            <small>
                Go to
                <a ui-sref="main.app.view ({id: ctrl.eventData.data.app.id })">
                    {{ ctrl.eventData.data.app.name }}
                </a>
            </small>
        </div>

    </div>
</div>
