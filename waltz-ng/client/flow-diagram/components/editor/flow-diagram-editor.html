<div class="waltz-flow-diagram-editor row">

    <!-- LOGICAL FLOW POPUP -->
    <div class="wfde-pop waltz-fade-if"
         ng-if="$ctrl.visibility.logicalFlowPopup">
        <waltz-flow-diagram-logical-flow-popup on-dismiss="$ctrl.onDismissPopup"
                                               logical-flows="$ctrl.popup.logicalFlows"
                                               node="$ctrl.popup.node"
                                               existing-entities="$ctrl.popup.existingEntities"
                                               is-upstream="$ctrl.popup.isUpstream"
                                               command-processor="$ctrl.issueCommands">
        </waltz-flow-diagram-logical-flow-popup>
    </div>


    <!-- PHYSICAL FLOW POPUP -->
    <div class="wfde-pop waltz-fade-if"
         ng-if="$ctrl.visibility.physicalFlowPopup">
        <waltz-flow-diagram-physical-flow-popup on-dismiss="$ctrl.onDismissPopup"
                                                logical-flow="$ctrl.popup.logicalFlow"
                                                physical-flows="$ctrl.popup.physicalFlows"
                                                physical-specifications="$ctrl.popup.physicalSpecifications"
                                                existing-entities="$ctrl.popup.existingEntities"
                                                command-processor="$ctrl.issueCommands">
        </waltz-flow-diagram-physical-flow-popup>
    </div>


    <!-- ANNOTATION POPUP -->
    <div class="wfde-pop waltz-fade-if"
         ng-if="$ctrl.visibility.annotationPopup">
        <waltz-flow-diagram-annotation-popup on-dismiss="$ctrl.onDismissPopup"
                                             annotation="$ctrl.popup.annotation"
                                             command-processor="$ctrl.issueCommands">
        </waltz-flow-diagram-annotation-popup>
    </div>


    <!-- DISJOINT NODE POPUP -->
    <div class="wfde-pop waltz-fade-if"
         ng-if="$ctrl.visibility.disjointNodePopup">
        <waltz-flow-diagram-node-popup on-dismiss="$ctrl.onDismissPopup"
                                       existing-entities="$ctrl.popup.existingEntities"
                                       command-processor="$ctrl.issueCommands">
        </waltz-flow-diagram-node-popup>
    </div>


    <!-- EDITOR -->
    <div class="col-md-2">
        <h5>Flow Diagram Editor</h5>

        <form>
            <label>Title</label>
            <input type="text"
                   class="form-control input-sm"
                   ng-model="$ctrl.title"
                   ng-change="$ctrl.onTitleChange($ctrl.title)">
        </form>
        <hr>

        <div class="small">
            <strong>Instructions:</strong>
            Use the context menu (typically <i>right mouse button</i>) to display menu options:
            <ul class="small"
                style="padding-left: 14px">
                <li>Use add/remove upstream/downstream nodes to illustrate the basic logical flows</li>
                <li>Add annotations to describe in more detail what is happening</li>
                <li>Decorate flows by describing the associated physical flows</li>
            </ul>

        </div>

        <hr>

        <button class="btn btn-sm btn-success"
                ng-click="$ctrl.doSave()">
            Save
        </button>
        &nbsp;
        <a ng-click="$ctrl.onCancel()"
           class="clickable">
            Cancel
        </a>
        <br>
        <br>
        <a class='clickable'
           ng-click="$ctrl.onCancel()">
            &laquo; Back to list
        </a>
    </div>

    <div class="col-md-10"
         style="border-left: 1px solid #ddd">
        <div ng-class="{ 'wfde-dim' : $ctrl.visibility.anyPopup }">
            <waltz-flow-diagram context-menus="$ctrl.contextMenus">
            </waltz-flow-diagram>
        </div>
    </div>
</div>
