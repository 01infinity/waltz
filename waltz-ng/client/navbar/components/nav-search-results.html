<div class="wns-results">
    <h4>
        Search Results:
        <span ng-bind="$ctrl.query"></span>
        <small class="pull-right">
            <a class="clickable"
               ng-click="$ctrl.dismiss()">
                <waltz-icon name="close"></waltz-icon>
            </a>
        </small>
    </h4>

    <hr>

    <div class="row">

        <!-- FILTERS -->
        <div class="col-md-4">
            <table class="table table-condensed">
                <colgroup>
                    <col width="10%">
                    <col width="80%">
                    <col width="10%">
                </colgroup>
                <tr ng-repeat="category in $ctrl.categories"
                    class="waltz-visibility-parent"
                    ng-class="{ clickable : $ctrl.results[category].length > 0 }"
                    ng-click="$ctrl.toggleCategory(category)">
                    <td>
                        <span class="waltz-visibility-child-50 waltz-fade-if"
                              ng-if="$ctrl.results[category].length > 0 ">
                            <waltz-toggle state="$ctrl.selectedCategory == category">
                            </waltz-toggle>
                        </span>
                    </td>
                    <td>
                        <span ng-class="{'text-muted' : ! $ctrl.results[category].length > 0}"
                              ng-bind="category | toDisplayName:'entity'">
                        </span>
                    </td>
                    <td>
                        <span ng-if="$ctrl.results[category].length > 0"
                              class="small"
                              ng-bind="$ctrl.results[category].length">
                        </span>
                    </td>
                </tr>
            </table>
        </div>


        <!-- RESULTS -->
        <div class="col-md-8">
            <table class="table table-condensed table-striped table-hover">
                <tbody ng-repeat="category in $ctrl.categories"
                       class="waltz-fade-if"
                       ng-if="$ctrl.selectedCategory === category || $ctrl.selectedCategory === null">
                    <tr ng-repeat="item in $ctrl.results[category]">
                        <td>
                            <waltz-entity-link tooltip-placement="'right'"
                                               ng-click="$ctrl.dismiss()"
                                               entity-ref="item">
                            </waltz-entity-link>
                            <small class="text-muted"
                                   ng-if="item.qualifier">
                                (
                                <span ng-bind="item.qualifier | limitTo:60"></span>
                                <span ng-if="item.qualifier.length > 60">...</span>
                                )
                            </small>
                        </td>
                    </tr>
                </tbody>

            </table>
        </div>

    </div>

</div>
