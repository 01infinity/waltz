<div>
    <waltz-page-header icon="user" name="{{ ctrl.person.displayName }}">
        <ol class="waltz-breadcrumbs">
            <li><a ui-sref="main">Home</a></li>
            <li><a ui-sref="main.person">People</a></li>
            <li>{{ ctrl.person.displayName }}</li>
        </ol>
    </waltz-page-header>


    <waltz-person-summary person="ctrl.person"
                          asset-costs="ctrl.assetCosts"
                          managers="ctrl.managers"
                          complexity="ctrl.complexity"
                          server-stats="ctrl.serverStats"
                          directs="ctrl.directs"
                          applications="ctrl.apps"
                          flows="ctrl.dataFlows">

    </waltz-person-summary>


    <div ng-if="ctrl.hasInvolvements">

        <waltz-section icon="desktop"
                       name="Application Portfolio">

            <uib-tabset>

                <uib-tab heading="Summary">
                    <div class="row">
                        <div class="col-sm-6">
                            <div>
                                <waltz-pie-table data="ctrl.charts.apps.byLifecyclePhase.data"
                                                 config="ctrl.charts.apps.byLifecyclePhase.config"
                                                 title="Applications By Lifecycle Phase">
                                </waltz-pie-table>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div>
                                <waltz-pie-table data="ctrl.charts.apps.byKind.data"
                                                 config="ctrl.charts.apps.byKind.config"
                                                 title="Applications By Type">
                                </waltz-pie-table>
                            </div>
                        </div>
                    </div>
                </uib-tab>


                <uib-tab select="showDirectTab = true"
                         heading="Direct"
                         ng-if="ctrl.involvements.direct.length > 0">

                    <div ng-if="showDirectTab"
                         ng-repeat="group in ctrl.involvements.direct | orderBy:'kind'">
                        <h4>
                            Role: {{group.kind | toDisplayName:'involvementKind'}}
                        </h4>

                        <waltz-app-table applications="group.apps">
                        </waltz-app-table>
                    </div>

                </uib-tab>


                <uib-tab select="showOversightTab=true"
                         heading="Oversight"
                         ng-if="ctrl.involvements.indirect.length > 0">

                    <div ng-if="showOversightTab">
                        <h4> Oversight Involvements <small>(Inferred via direct reports)</small></h4>
                        <waltz-app-table applications="ctrl.involvements.indirect">
                        </waltz-app-table>
                    </div>

                </uib-tab>

            </uib-tabset>

        </waltz-section>

        <!-- COMPLEXITY -->
        <waltz-complexity-section complexity="ctrl.complexity"
                                  apps="ctrl.apps">
        </waltz-complexity-section>


        <!-- COSTS -->
        <waltz-asset-costs-section asset-costs="ctrl.assetCosts">
        </waltz-asset-costs-section>

    </div>

</div>
