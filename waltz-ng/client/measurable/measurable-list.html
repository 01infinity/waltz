<div>
    <waltz-page-header name="Other Viewpoints"
                       icon="puzzle-piece">
        <ol class="waltz-breadcrumbs">
            <li><a ui-sref="main">Home</a></li>
            <li><span ng-bind="ctrl.visibility.tab | toDisplayName:'measurableKind'"></span></li>
        </ol>
    </waltz-page-header>

    <div class='waltz-page-summary-attach waltz-page-summary'>
        <div class="row">
            <div class="col-sm-12">
                <div class="waltz-tabs">
                    <!-- TAB HEADERS -->
                    <input type="radio"
                           ng-repeat-start="tab in ctrl.tabs track by tab.kind.code"
                           ng-model="ctrl.visibility.tab"
                           ng-value="tab.kind.code"
                           ng-disabled="! tab.measurables"
                           name="tab"
                           id="{{ tab.kind.code + $id }}">
                    <label for="{{ tab.kind.code + $id }}"
                           ng-repeat-end>
                        <span ng-bind="tab.kind.name"
                              ng-class="{ italics: tab.ratings.length == 0 }">
                        </span>
                    </label>

                    <!-- TAB CONTENT -->
                    <div ng-repeat="tab in ctrl.tabs track by tab.kind.code"
                         ng-class="{ 'wt-active': tab.kind.code == ctrl.visibility.tab }"
                         class="wt-tab">

                        <br>

                        <!-- DIAGRAMS -->
                        <div class="row" ng-if="ctrl.diagramsByKind[tab.kind.code].length > 0">
                            <div class="col-sm-12">
                                <waltz-svg-diagrams diagrams="ctrl.diagramsByKind[tab.kind.code]"
                                                    block-processor="ctrl.blockProcessor">
                                </waltz-svg-diagrams>
                                <hr>
                            </div>
                        </div>

                        <div class="row">
                            <!-- TREE -->
                            <div class="col-sm-7">
                                <treecontrol class="tree-light"
                                             tree-model="tab.treeData"
                                             options="ctrl.treeOptions"
                                             expanded-nodes="tab.expandedNodes"
                                             order-by="'-name'">

                                <span title="{{ node.description }}"
                                      ng-class="{ 'text-muted': node.rating == null }"
                                      class="no-overflow">
                                    <a ui-sref='main.measurable.view ({id: node.id })'
                                       ng-class="{ 'italics' : ! node.concrete }">
                                        <span ng-bind="node.name"></span>
                                        <span class="wml-bar-chart"
                                              ng-if="node.totalCount > 0"
                                              ng-style="{width: tab.xScale(node.totalCount) + 'px'}"
                                              uib-popover="{{ node.totalCount }} applications"
                                              popover-append-to-body="true"
                                              popover-placement="right"
                                              popover-trigger="mouseenter">
                                        </span>
                                    </a>
                                </span>
                                </treecontrol>
                            </div>

                            <!-- PANELS -->
                            <div class="col-sm-5">
                                <h5 ng-bind="tab.kind.description">
                                </h5>

                                <waltz-static-panels render-mode="chromeless"
                                                     panels="ctrl.panelsByKind[tab.kind.code]">
                                </waltz-static-panels>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
