<!--
  ~ Waltz - Enterprise Architecture
  ~ Copyright (C) 2016, 2017, 2018, 2019 Waltz open source project
  ~ See README.md for more information
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Lesser General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Lesser General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Lesser General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->

<!-- LOADING -->
<waltz-loading-notification show="$ctrl.visibility.loadingFlows"
                            name="Loading Flow Data">
</waltz-loading-notification>

<div class="row">

    <!-- GRAPH -->
    <div class="col-sm-12">

        <!-- TOO MUCH DATA -->
        <div ng-if="$ctrl.filteredFlowData.entities.length >= 400 && !$ctrl.visibility.ignoreLimits">
            <div class="alert alert-warning">
                <waltz-icon name="warning" size="lg"></waltz-icon>
                This graph will have <strong>too many nodes</strong> to render smoothly.
                Use the configure button too limit the amount of data to show.  Alternatively
                the data is available via the 'Table' tab.

                <br>

                If you still want to see the graph click
                <a class="clickable" ng-click="$ctrl.visibility.ignoreLimits = true">
                    here
                </a>
                - however be aware that your machine may struggle.
            </div>
        </div>

        <!-- BOINGY -->
        <div ng-if="$ctrl.filteredFlowData.entities.length < 400  || $ctrl.visibility.ignoreLimits">

            <waltz-logical-flow-diagram data="$ctrl.filteredFlowData"
                                        tweakers="$ctrl.graphTweakers">

                <filter-control>
                    <waltz-flow-filter-options visible="$ctrl.optionsVisible"
                                               on-change="$ctrl.filterChanged"
                                               used-types="$ctrl.usedDataTypes">
                    </waltz-flow-filter-options>
                </filter-control>

            </waltz-logical-flow-diagram>

            <div class="small text-muted">
                Dragging nodes will pin them.  Double click to unpin.  If an application is gray
                it is not a member of this group.
            </div>
        </div>
    </div>

</div>

